#! /usr/bin/env python3

from argparse import ArgumentParser
from subprocess import Popen, call, check_output, PIPE

parser = ArgumentParser()

parser.add_argument("file",
    help="File listing all binaries to objdump, one per line.")

args = parser.parse_args()

with open(args.file, "r") as inFile:
    errors = list()
    for line in inFile:
        cmd = ["objdump", "-d", line.strip()]
        out_name = line.strip()+".obj"
        outfile = open(out_name, "w")
        process = Popen(cmd, stdout=outfile, stderr=PIPE)
        stdout, stderr = process.communicate()
        if stderr:
            errors.append(stderr)

    print(errors)
